# Run tests before push
echo "🧪 Running affected tests..."
bun nx affected --target=test --parallel=3

# Run build to ensure everything compiles
echo "🔨 Running affected build..."
bun nx affected --target=build --parallel=3

# Check if there are changes after formatting
if ! git diff --quiet; then
  echo "⚠️  Files were formatted. Please review and stage the changes."
  git status --short
  exit 1
fi

echo "✅ Pre-push checks passed!"
